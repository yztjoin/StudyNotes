物理层、应用、

网络七层协议：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

**开放式系统互联通信参考模型**（英语：Open System Interconnection Reference Model，缩写为 OSI），简称为**OSI模型**（OSI model），一种[概念模型](https://baike.baidu.com/item/概念模型/3187025)，由[国际标准化组织](https://baike.baidu.com/item/国际标准化组织/779832)提出，一个试图使各种计算机在世界范围内互连为网络的标准框架

**TCP/IP（Transmission Control Protocol/Internet Protocol，传输控制协议/网际协议）**是指能够在多个不同网络间实现信息传输的协议簇。TCP/IP协议不仅仅指的是[TCP](https://baike.baidu.com/item/TCP/33012) 和[IP](https://baike.baidu.com/item/IP/224599)两个协议，而是指一个由[FTP](https://baike.baidu.com/item/FTP/13839)、[SMTP](https://baike.baidu.com/item/SMTP/175887)、TCP、[UDP](https://baike.baidu.com/item/UDP/571511)、IP等协议构成的协议簇， 只是因为在TCP/IP协议中TCP协议和IP协议最具代表性，所以被称为TCP/IP协议

![image-20220127223017075](..\assets\image-20220127223017075.png)

# 协议

 对等层的实体有一个规则集合作为通讯协议，因此复杂且不同的端可以通讯

**协议分层次：**应用层、传输层、网络层、网络接口层

- **应用层**：HTTP
- **网络层**：IP
- **传输层**：TCP、UDP等

![image-20220127230659441](..\assets\image-20220127230659441.png)

**一个协议需要包括的内容**：语法、语义、时序、动作

**服务器是什么**

- 应用层协议等级以下的应用实体

- 为分布式应用提供通讯服务的基础设施

**接入链路和骨干链路**



# 第一章：网络结构

**按照网络组成类型来划分聚类**（网络结构）：网络边缘、网络核心、接入网和物理媒体

- **网络边缘系统**：主机、应用程序（网络游戏、app应用等）
- **网络核心（起到数据交换的作用）**：网络交换节点以各个圆所组成的链路叫网络核心
- **接入网、物理媒体**：边缘网络与网路核心的链接（有线或者无线的通讯链路）

**网络核心**：是以全球范围内的路由器交换机和链接他们的链路所组成的分布式系统相互配合达到源主机到目标主机的数据传输（发布和接收）

**网络应用是互联网存在的理由**

## 按照网络类型划分

## 网络边缘 

网络边缘包括：分布式应用、主机、支持分布式应用通讯的基础设置

**基础设施**

- **作用**：为服务器的应用提供通讯服务
- **包括**：应用层以下的都是基础设施、应用层协议等级以下的应用实体

**两种模式**：C/S模式（Client/server）也就是客户端/服务器、P2P（peer-to-peer）也就是对等模式

**C/S模式**：浏览器 / web服务器

**P2P模式**：P2P打破了传统的C/S模式，在网络中每个点的地位都是对等的可以是服务器也可以实客户端，也就是说每个节点都能为其他节点提供服务同时也可以享用其他节点的服务

**PPP（point-to-point）和P2P（peer-to-peer）的不同**

- **性质不同**：PPP协议是在点对点连接上传输多个数据包所提供的一个标准方法，P2P是分配工作和工作负载的分布式应用架构
- **特点不同**：PPP是点到点串行通讯协议，P2P是一种网络结构的思想
- **模式不同**：P2P打破了传统的C/S模式，在网络中每个点的地位都是对等的可以是服务器也可以实客户端，也就是说每个节点都能为其他节点提供服务同时也可以享用其他节点的服务。PPP协议通信完毕时，NCP释放网络层链接，收回原来分配出去的IP地址

**向上层提供的服务有两种**：面向连接的（TCP）、无连接的（UDP）

**面向链接服务：**TCP服务

**TCP服务**：可靠性、流量控制、拥塞控制

- 可靠性：确认和重传
- 流量控制：发送方不会淹没接收方
- 拥塞控制：当网络拥塞时，发送方降低速率

**无连接的服务**：UDP服务

## 网络核心

由分组交换构成的网络

**数据怎样通过网络进行传输？**

- 电路交换（circuit switch）：为每一个呼叫预留一个专有电路，如电话网
- 分组交换（packet switch）

### 电路交换：FDM和TDM

Q：两个交换节点连在一起采用什么方法来划分piece？

A：将带宽分成片：频分（Frequency-division multiplexing）、时分（Time-division multiplexing）、波分（Wave-division multiplexing）

TDM（时分）：如果把整个带宽分为24个时间段，24个时间段为一个周期，一个用户分配一个时间端，如果带宽为1.536Mbps，则每个用户会分配（1.536 * 1000）/ 24=64Kbps，因此使用TDM影响单个带宽的速率有几点原因：带宽、单个周期内的时间段

使用TDM计算文件传输的速度需要几点前提：传播时间 = 文件大小Kb / （总带宽M / 1000）/ 周期片段 +  端到端连接建立时间 + 传播延迟，传播延迟=两个主机距离 / 光速（其实是使用的传播介质在大气中的传播速度）

（640/64 + 0.5）= 10.5s

### **分组交换**：虚电路网络（有连接）和数据报网络（无连接）

传输总时间 = 排队时延+传播时延+传输时间+单个存储时间（感觉有几个节点就需要翻倍）

**排队：**分组将会排队，等待传输

**丢失：**如果路由器的缓存用完了，分组将会丢失

因为分组的排队等待会占用缓存，如果带宽不够高则就会造成堵塞，排队多了就回对后来者丢弃（自我理解）

**虚电路网络**

- 虚电路的链接不仅仅体现在发送主机和目标主机上，同时体现在中间所经过的所有节点之上
- 每一个分组都带有VCID代表目标的下一跳
- 在呼叫建立时决定路径，并在传输中保持不变
- 路由器维持每个呼叫的状态信息

**数据报网络**

- 分组的目标地址决定下一条
- 在不同的阶段路由可以改变
- 类似：问路

**面向连接和有链接的区别**

- TCP是面向连接，TCP向应用进程提供服务的时候，仅仅体现在端系统和应用实体上，中间的节点不维护他们的状态
- 有链接网络。体现在虚电路网络，链接不仅仅体现在发送主机和目标主机上，同时体现在中间所经过的所有节点之上

## 接入网和物理媒体

端系统--网络边缘--网络核心

作用：网络边缘接入网络核心

**如何接入？**

1. 住宅网接入
2. 单位网络接入
3. 无线网络接入

接入网络的带宽分为两种：共享和独享，共享则每个个体户分配总的上网带宽，独享则独自享受运营商的带宽。

### modem：调制解调器

俗称的猫接入，将上网数据调制加载到音频信号上，在电话线上传输，在局端其中的数据解调出来：反之亦然。

传输的几种方式：调频、条幅、调相位、总和调制

在音频的载波数据上修改，变成所需要的上网数据

缺点：56Kbps的速率直接接入路由器（通常更低），不能同时上网和通话，不能总是在线

### digital subscriber line（DSL）

分离电话线：一部分用于电话通讯，一部分用于上网

用于上网的分为上行数据和下行数据，两个数据如果是不对称的话叫ADSL

### 电缆网络

有限电视原本用于单项传输，只能传向下行

把有限电视的线路传输进行数字化和双向改造，使用的是FDM

HFC：hvbrid fiber coax（混合光纤同轴电缆），非对称上行30Mbps，下行2Mbps

线缆和光纤网络将个家庭用户接入到ISP（互联网提供服务商）路由器

### 无线接入

无线LANs（建筑物内部：例如无线路由器提供的）和广域无线接入（由运营商提供的：例如3G、4G网络）

### 物理媒介

连接网络的介质

- 导引性媒体：光纤、以太网网线、同轴电缆、双绞线
- 非导引性媒体：无线电                               

光纤传输：速率快、带宽高

## Internet结构和ISP

历史发展：如果所有的网络需要实现互联的话，每个交换机需要与其他交换机互联，复杂度O(n²)，到达一定规模之后会导致可扩展性非常差，因此出现ISP

ISP（Internet Service Provider：互联网服务提供商）：ISP是经国家主管部门批准的正式运营企业，享受国家法律保护，一般是服务器与虚拟主机提供商必须具备的，相互连接通过IXP（Internet exchange point：互联网交换点）

ICP（Internet Content Provider：网络内容服务商）：提供业务，不与ISP同级，仅仅是对用户提供服务，但是大型公司可以自己部署，例如：谷歌

center provider network（中心服务商网络）：大公司由于需要向世界或者较远地区提供优质化服务，则自身拉光纤配置DC（data center：数据中心），配置的DC位置一般是离ISP比较近，一般这种会绕过access ISP和Regional ISP（区域ISP）直接接入ISP

IXP：（Internet exchange point：互联网交换点）

ISP==》IXP==》Regional ISP（区域ISP）==》access ISP

**ISP之间的连接**

- POP：搞成ISP向客户网络的接入点，设计费用结算
- 对等接入：2个ISP对等互联，不涉及费用结算
- IXP：多个对等ISP互联互通之处
- ICP：自己部署专用网络，同时和各级ISP相连接

## 分组延时、丢失和吞吐量

>分组延时分为几种：节点处理延时、排队延时、传播延时

**节点处理延时（固定的）**

- 检查bit级差错
- 检查分组首部和决定将分组导向何处

<span id='jump1'>**排队延时（随机的）**</span>

- 分组到达链路的速率超过了链路的输出速率就会造成排队延时
- 某一分组在队尾，从队头到它之间的传输时间也是有延时

>**流量强度**
>
>设计的流量强度会影响到分组传输的排队延时
>
>链路带宽（R）、分组长度（L）、分组到达队列的平均速率（a） 
>
>La / R  = 流量强度
>
>流量强度趋近于0的时候，排队延时无穷大
>
>**分组丢失**
>
>解释：因为链路队列的缓冲区存储有限，当链路分组队列达到上限后新加入的队列会被自动遗弃

**传输延时（根据单位分组长度而定）**

- 因为传输时需要对分组数据进行存储转发
- 分组长度 / 网络带宽

**传播延时（根据传输距离而定）**

- 物理媒介传输一段分组数据到目的地其中的传输时间就是传播延时
- 传播长度 / 在该媒介的传播速度



| 传播延时 | 节点处理延时                     | 排队延时                         | 传输延时                             | 传播延时                                                   |
| -------- | :------------------------------- | -------------------------------- | ------------------------------------ | ---------------------------------------------------------- |
| 时间     | 固定的，通常是微秒               | 取决于堵塞程度                   | 根据单位分组长度而定                 | 根据传输距离而定                                           |
| 计算方式 | 节点处理数据的时间               | /                                | 分组长度(L) / 网络带宽(R)            | 传播长度(D) / 在该媒介的传播速度(S)                        |
| 描述     | 检查分组首部和决定将分组导向何处 | 检查分组首部和决定将分组导向何处 | 因为传输时需要对分组数据进行存储转发 | 物理媒介传输一段分组数据到目的地其中的传输时间就是传播延时 |
| 符号     | d(proc)                          | d(queue)                         | d(trans)                             | d(pron)                                                    |

所以分组数据从主机到达目标主机有可能经历：排队延时、节点处理延时、传输延时、传播延时

**吞吐量**

- 解释：在源端和目标端之间的传输速率（数据量 / 单位时间）
- 瞬间吞吐量：在一个时间点的速率
- 平均吞吐量：在一个长时间内平均值
- 短板效应：如果传输路径上有多个传输速率不同的链路组成，平均吞吐量取传输速率最少的

LAN（局域网：Local Area Network）、WLAN（无线局域网：Wireless Local Area Network）、WAN（广域网：Wide Area Network）

## 协议层和服务模型

### 协议基本概述

协议的实现借助于下层的服务才能实现，协议实现的目的是为了向上层提供更好的服务

实现本层协议的时候需要借助下层服务提供的接口interface实现

应用的最高层是网络存在的理由

计算机网络分成一个个功能明确的层次，具体实现是使用协议实体的相互动作，协议实体如何实现交互的动作？借助于层接的接口用下层的服务来交换PDU，目的是为了向上层提更更好的服务，向上层提供的服务包括当前层的下层的服务的总和与对等层的交互实现的新特性

**服务**：底层实体向上层实体提供他们之间的通信能力

**服务点（SAP：Services Access Point）**：上层使用下层提供的服务通过层间的接口--地点

**原语（primitive）：**上层使用下层的形式，高层使用底层的服务，以及底层向高层提供服务都是服务器访问原语来进行交互--形式

同一个服务提供者需要同时向多个上层用户提供服务，

### 服务的类型

**面向连接（TCP）：**

- 两个用户在使用下层提供的服务之前需要有一个握手的过程，这种服务就是面向连接的服务

**无连接（UDP）：**

- 两个对等层实体在通信前不需要建立连接，不预留资源，不需要双方都是活跃的

**服务和协议的区别**

- 服务是层级之间的关系，协议是对等层的实体在通讯过程当中应该遵守的规则的集合，服务是在相邻两层之间利用层间的关系在SAP通过原语的方式由下层向上层提供服务

**服务和协议的联系**：实现本层协议的时候需要使用下层提供的服务，本层实现的协议目的是为了向上层提供更好的服务

### 数据单元

**SDU**（服务数据单元：service data unit）

**PDU**（协议数据单元：ptotocol data unit）

**IDU**（接口数据单元：interface data unit）

**ICI**（接口控制信息：interface control infomation）

上层传输的SDU通过SAP传输到下一层，由下一层处理上层的SDU增加header形成本层的PDU，同时又三种情况

- 一对多，上层SDU数据单元较大，下层需要分块处理对每一块增加一个header形成多个本层的PDU
- 多对一，上层的SDU数据单元很小，下层可以合并上层多个较小的SDU然后增加一个header姓曾一个本层的PDU
- 一对一，直接增加header新城本层PDU

**分层处理和实现复杂系统的好处？**

概念化：结构清晰，便于标识网络组件，以及描述其相互关系

结构化：模块化更利于系统的维护和升级

### internet协议栈

物理层-》链路层-》网络层-》传输层-》应用层

物理层：线路之间bit和bit的传输

链路层：提供的是相邻两点之间由物理层传输的bit和bit的传输包装成一个帧，也就是相邻两点以帧为单位的传输

网络层：提供的是以相邻两点之间的帧传输的基础之上向传输层提供端到端之间的传输，两个重要的功能：转发与路由

传输层：解决的是服务进程到服务进程的数据传输，是由端口进行区分 同时把不可靠的报文由TCP包装成可靠的报文

应用层：在传输层提供的进程到进程之间可靠传输的基础之上实现各种各样的网络应用

### 各个层次的协议数据单元

应用层：报文（message）

传输层：报文段（segment）：TCP段、UDP数据报

网络层：分组packet（如果无连接方式：数据报文段datagram）

数据链路层：帧（frame）

物理层：位（bit）

## 总结与习题

是什么？作用？目的？

协议

- 概念：对等实体有一组规则集合作为通讯协议
- 作用：网络之间信息通信的桥梁
- 目的：多端相互通讯
- 组成内容：语法、语义、时序
- 语法：确定协议元素的格式，数据与控制信息的结构与格式
- 语义：确定协议元素的类型，规定通信双方要发何种信息，完成何种动作和做出何种应答
- 时序：规定事件实现顺序的详细说明

按照网络结构类型划分：网络边缘、网络核心、接入网

网络边缘

- 概念内容：主机、支持分布式应用通讯的基础设施
- 作用：应用数据存储

网络核心

- 内容：路由器、交换机
- 作用：信息的存储与转发
- 目的：实现从源主机到目标主机的信息交换
- 交换的类型：电路交换和分组交换
- 电路交换：TDM（时分）、频分（FDM）、波分（WDM）
- 时分的电路交换的计算方式：传播时间 = 文件大小Kb / （（总带宽M / 1000）/ 周期片段） +  端到端连接建立时间 + 传播延迟
- 传播延迟 = 两个主机距离 / 光速（其实是使用的传播介质在大气中的传播速度）
- 分组交换：虚电路网络（如今很少使用）和数据报网络
- 两种分组交换的区别：虚电路网络是有连接的数据报网络是无连接的
- 分组交换和电路交换的区别：分组交换每一个用户都可以享受全部的带宽，而电路交换需要大家共享带宽
- 分组交换的传播时间计算：传播时间 = 文件大小 / 总带宽 + 传播延时 + 排队延时

接入网络

- 概念：物理层的传输介质、无线接入（WLAN）、物理媒体：光纤、双绞线、同轴电缆
- 作用：传输通信信息
- 目的：接入网络核心

### “主机”和“端系统”有什么不同？

没有什么不同，主机就是端系统

### 列举几种不同类型的端系统……



### Web服务器是一种端系统么？

web服务器是一种端系统